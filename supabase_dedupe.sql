-- ============================================================
-- Supabase 중복 데이터 정리
-- Supabase 대시보드 > SQL Editor 에서 필요한 블록만 골라 실행하세요.
-- ============================================================

-- ------------------------------------------------------------
-- [1] 품목(items): code 기준 중복 제거 (id 큰 것만 남김)
-- ------------------------------------------------------------
DELETE FROM items a
USING items b
WHERE a.code = b.code AND a.id < b.id;


-- ------------------------------------------------------------
-- [2] 거래처(vendors): code 기준 중복 제거 (id 큰 것만 남김)
-- ------------------------------------------------------------
DELETE FROM vendors a
USING vendors b
WHERE a.code = b.code AND a.id < b.id;


-- ------------------------------------------------------------
-- [3] 주문·재고까지 전부 비우고 마이그레이션 한 번만 다시 돌리기
--     (아래 4줄 실행 후 GAS에서 migrateSheetsToSupabase 한 번만 실행)
-- ------------------------------------------------------------
-- TRUNCATE stock_logs;
-- TRUNCATE orders;
-- TRUNCATE store_settings;
-- TRUNCATE items;
-- TRUNCATE vendors;
